!function(e,t){"function"==typeof define&&(define.amd||define.cmd)?define("m",function(exports){return t(e,exports)}):e.M=t(e,{})}(this,function(e,t){function n(e){if(!("classList"in e)){e.classList={node:e};for(var t in x)e.classList[t.slice(1)]=x[t]}return e.classList}var i=function(e,t,n){n||(n=null);for(var i=0,r=e.length;r>i&&!1!==t.call(n,e[i],i,e);i++);},r=function(e){return e+="",e.replace(/#.*/,"")},a=e.location,s=e.document,o=s.body,l=s.createElement("a"),c=function(e){return l.href=e,f(l)},u=function(e){return l.href=e,r(l.href)},h=function(e){e||(e=a);var t=e.hash;return"#"===t.charAt(0)&&(t=t.substr(1)),t},f=function(e){return e||(e=a),{url:e.href,rurl:r(e.href),host:e.host,hash:h(e),protocol:e.protocol,origin:e.origin||e.protocol+"//"+e.host,pathname:e.pathname,search:e.search,port:e.port}},d=function(e){var t="";do if(e!==o&&1===e.nodeType&&((t=e.getAttribute("data-href"))||(t=e.href)))break;while(e=e.parentElement);return{href:t||"",target:e}},p=function(e){return e.indexOf("-")<0?e:e.replace(/-[^-]/g,function(e){return e.charAt(1).toUpperCase()})},g=function(e){var t={};if(e.dataset)for(var n in e.dataset)t[n]=e.dataset[n];else for(var i,r,a=e.attributes,s=/^data-(.+)$/i,o=0,l=a.length;l>o;o++)i=a[o].name||a[o].nodeName,(r=i.match(s))&&(t[p(r[1])]=a[o].value||a[o].nodeValue);return t},v=Object.prototype,m=(v.hasOwnProperty,v.toString),y=function(e){return"[object Function]"==m.call(e)},w=function(e){return"[object Object]"===m.call(e)&&Object.getPrototypeOf(e)===v},C=t.extend=function(){var e,t,n,i,r,a,s=arguments[0]||{},o=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},o++),"object"==typeof s||y(s)||(s={}),o===l&&(s=this,o--);l>o;o++)if(null!=(e=arguments[o]))for(t in e)n=s[t],i=e[t],s!==i&&(c&&i&&(w(i)||(r=Array.isArray(i)))?(r?(r=!1,a=n&&Array.isArray(n)?n:[]):a=n&&w(n)?n:{},s[t]=C(c,a,i)):void 0!==i&&(s[t]=i));return s},b={_eventData:null,on:function(e,t){this._eventData||(this._eventData={}),this._eventData[e]||(this._eventData[e]=[]);var n=!1;i(this._eventData[e],function(e){return e===t?(n=!0,!1):void 0}),n||this._eventData[e].push(t)},off:function(e,t){this._eventData||(this._eventData={}),this._eventData[e]&&this._eventData[e].length&&(t?i(this._eventData[e],function(n,i){return n===t?(this._eventData[e].splice(i,1),!1):void 0}):this._eventData[e]=[])},trigger:function(e){if(this._eventData||(this._eventData={}),this._eventData[e]){var t=this._eventData[e].slice.call(arguments,1);i(this._eventData[e],function(e){e.apply(null,t)})}}},E=function(){},k="m-"+(new Date).getTime()+"-",_=1,S={},V=function(e){var t="";return e&&(t=S[e])||(t=k+_++,e&&(S[e]=t)),t},O=/[^, ]+/g,x={_toString:function(){var e=this.node,t=e.className,n="string"==typeof t?t:t.baseVal;return n.split(/\s+/).join(" ")},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;rsvg.test(t)?t.setAttribute("class",e):t.className=e}};return"add,remove".replace(O,function(e){t[e+"Class"]=function(t,i){return i&&"string"==typeof i&&t&&1===t.nodeType&&i.replace(/\S+/g,function(i){n(t)[e](i)}),this}}),t.innerHTML="undefined"!=typeof $&&y($.prototype.html)?function(e,t){$(e).html(t)}:function(){function e(e){"string"!=typeof e&&(e+=""),e=e.replace(a,"<$1></$2>").trim();var t,s=(r.exec(e)||["",""])[1].toLowerCase(),u=n[s]||n._default,h=c.cloneNode(!1);u.innerHTML=e;{var f=u.getElementsByTagName("script");[].forEach}if(f.length)for(var d,p,g=0;d=f[g++];)o[d.type]&&(p=l.cloneNode(!1),i(d.attributes,function(e){p.setAttribute(e.name,e.value)}),p.text=d.text,d.parentNode.replaceChild(p,d));for(;t=u.firstChild;)h.appendChild(t);return h}var n=new function(){t.extend(this,{option:s.createElement("select"),thead:s.createElement("table"),td:s.createElement("tr"),area:s.createElement("map"),tr:s.createElement("tbody"),col:s.createElement("colgroup"),legend:s.createElement("fieldset"),_default:s.createElement("div"),g:s.createElementNS("http://www.w3.org/2000/svg","svg")}),this.optgroup=this.option,this.tbody=this.tfoot=this.colgroup=this.caption=this.thead,this.th=this.td};"circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use".replace(O,function(e){n[e]=n.g});var r=/<([\w:]+)/,a=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,o={"":1,"text/javascript":1,"text/ecmascript":1,"application/ecmascript":1,"application/javascript":1},l=s.createElement("script"),c=s.createDocumentFragment();return function(t,n){var i=e(n);t.innerHTML="",t.appendChild(i),i=null}}(),t.extend({rword:O,noop:E,each:i,trimUrl:r,parseUrl:c,getHash:h,getFullUrl:u,getHrefAndTarget:d,camelize:p,getDatesetObj:g,isFunction:y,isArray:function(e){return Array.isArray(e)},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},isDefined:function(e){return"undefined"!=typeof e},isPlainObject:w,parseLocation:f,getUIDByKey:V,hasClass:function(e,t){return 1===e.nodeType&&n(e).contains(t)},location:a,document:s,body:o,html:s.documentElement,Base:b,extendByBase:function(e){return C(e,b)},Array:{ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,n){var i=e.indexOf(n);return~i?t.Array.removeAt(e,i):!1},indexOfByKey:function(e,t,n){for(var i=t[n],r=0,a=e.length;a>r;r++)if(e[r][n]===i)return r;return-1}},Object:{create:Object.create||function(e){return{__proto__:e}},setPrototypeOf:Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},getPrototypeOf:Object.getPrototypeOf||function(e){return e.__proto__},keys:Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}}}),t}),function(e,t){"function"==typeof define&&(define.amd||define.cmd)?define("m.history",function(require){var n=require("m");return n.history=t(e,n),n}):M.history=t(e,e.M)}(this,function(e,t){var n={},i=[],r=function(e){return("/"+e+"/").replace(/^\/+|\/+$/g,"/")},a=t.document.getElementsByTagName("base");a=a&&a.length?r(a[0].getAttribute("href")):"/";var s=t.parseLocation().origin,o=e.history,l=(e.navigator||{}).userAgent;l||(l="");var c=parseInt((/android (\d+)/.exec(l.toLowerCase())||[])[1],10);isNaN(c)&&(c=void 0);var u=/Boxee/i.test(l),h=!(!(o&&o.pushState&&o.replaceState)||4>c||u),f={support:h,_startd:!1,index:-1,base:a,start:function(n){if(!this._startd){n||(n={});var i=n.base;t.isDefined(i)&&t.isString(i)&&(this.base=r(i)),this._startd=!0,this.options=t.extend({enablePushState:!0},n),h&&(this.options.enablePushState&&e.addEventListener("popstate",this.onChange),t.document.addEventListener("click",this.onDocClick)),this.onChange({type:"popstate",state:f.getUrlState(t.location.href)}),this.trigger("inited")}},stop:function(){h&&(this.options.enablePushState&&e.removeEventListener("popstate",this.onChange),t.document.removeEventListener("click",this.onDocClick)),this._startd=!1,this.index=-1,n={},i=[]},getPath:function(e){var n=t.parseUrl(e),i=decodeURIComponent(n.pathname+n.search),r=this.base.slice(0,-1);return i.indexOf(r)||(i=i.slice(r.length)),i.slice(1)},onDocClick:function(e){if(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)return!0;var n=e.target,i=t.getHrefAndTarget(n);n=i.target;var r=i.href;if(f.checkUrl(r)&&!n.target){var a=t.getDatesetObj(n),s=f.createStateObject(r,a);return e.preventDefault(),f.pushState(s,!0),!1}},checkUrl:function(e,n){n||(n=t.parseUrl(e).origin);var i=/^javascript:/;return e&&s===n&&!i.test(e)},push:function(e,t){var n=this.createStateObject(e,t);this.pushState(n)},pushState:function(e,n){(n||this.checkUrl(e.url,e.origin))&&e.url!==f.getCurrentState().url&&(this.options.enablePushState&&t.isUndefined(e.data.href)&&e.url!==t.location.href&&o["true"==e.replace?"replaceState":"pushState"](e,e.title,e.url),this.onChange({state:e}))},onChange:function(e){var n,i=e&&e.state||f.getUrlState(t.location.href),r=f.getCurrentState();if(r&&i.rurl===r.rurl)return void("popstate"!==e.type&&i.hash&&(n=t.document.getElementById(i.hash),n&&n.scrollIntoView()));var a=f.storeState(i),s="";if(a>f.index)s="forward";else{if(!(a<f.index))return e.preventDefault(),!1;s="back"}"back"!==s&&"back"===i.data.rel?s="back":"back"===s&&"back"!==i.data.rel&&"back"===r.data.rel&&(s="forward"),t.document.title=i.title,f.index=a,f.trigger(s,i,r),f.trigger("change",s,i,r)},getUrlState:function(e){return e=t.getFullUrl(e),n[e]||this.createStateObject(e)},getCurrentState:function(){var e=i[this.index];return e?n[e]||null:null},getPrevState:function(){var e=i[this.index-1];return e?n[e]||null:null},createStateObject:function(e,n,i){e?"/"===e.charAt(0)&&(e=e.slice(1),e=this.base+e):e=t.location.href;var r=t.parseUrl(e);return{data:n||(n={}),title:i||n.title||t.document.title,rurl:r.rurl,url:r.url,origin:r.origin,hash:r.hash}},hasUrl:function(e){return!!n[e]},storeState:function(e){var r=-1,a=e.rurl;return this.hasUrl(a)?r=i.indexOf(a):(i.push(a),r=i.length-1),n[a]=t.extend(!0,n[a],e),this.clearCache(r),r},clearCache:function(e){t.isUndefined(e)&&(e=-1);var r=i.slice(e+1);r.forEach(function(e){delete n[e]}),i.length=e+1},getCache:function(){return{urlCache:i,stateCache:n}}};return t.extendByBase(f),f}),function(e,t){"function"==typeof define&&(define.amd||define.cmd)?define("m.router",function(require){var n=require("m.history");return n.router=t(e,n,n.history),n}):M.router=t(e,M,M.history)}(this,function(e,t,n){function i(e,n,i){e?e.$routeView=this:this.$root=!0,n&&(this.$parent=n),this.routes=[],this.$parentRouteEle=null,this.maskEle=null,this.pageViewState=null,this.viewsContainer=null,this.options=i,this.pagesCache=[],this.templateCache={},this.options.cacheViewsNum<1&&(this.options.cacheViewsNum=1),e||this.setViewsContainer(t.document.body)}function r(e,t,n){var i=e.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!t)return i;var r=n?"?":"";return i+r+"("+t+")"+r}function a(e,t){for(var n=t.keys,i=0,r=n.length;r>i;i++){var a=n[i],s=e[i]||"";if("function"==typeof a.decode)var o=a.decode(s);else try{o=JSON.parse(s)}catch(l){o=s}e[i]=t.params[a.name]=o}t.args=e}function s(e){var t=e.args;if(t)if(e.keys.length){var n=e.$parentArgsLen;t.splice(0,n)}else t.length=0}var o=function(e){var t=e.split("?"),n={},i=t[0],r=t[1];if(r)for(var a,s=r.split("&"),o=s.length,l=0;o>l;l++)s[l]&&(a=s[l].split("="),n[decodeURIComponent(a[0])]=decodeURIComponent(a[1]));return{path:i,query:n}},l=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,c=!1,u="page-view",h="in",f={cacheTemplate:!0,viewsSelector:"",viewClass:"",animation:!0,aniClass:"slide",maskClass:"mask",showLoading:!0,cacheViewsNum:3},d=t.Object.keys(f),p=t.document.createElement("div"),g=function(){for(var e,t=p.style,n=["a","webkitA","MozA","OA","msA"],i=["animationend","webkitAnimationEnd","animationend","oAnimationEnd","MSAnimationEnd"],r=0,a=n.length;a>r;r++)if(e=n[r]+"nimation",e in t)return i[r];return"animationend"}(),v=["cacheTemplate","callback","getTemplate","$regexp","regexp","viewClass","keys","onDestroy","pattern","$routeView","$parentArgsLen","onEnter","onLeave"];t.extend(i.prototype,{route:function(e,n,i,r,o){function l(e){var n=g.getOption(e,i.state,"cacheTemplate"),r=t.getUIDByKey(e.path);if(i.first){var a=g.viewsContainer.getElementsByClassName(u)[0];a&&(a.id&&a.id!=r||(g.templateCache[e.path]=a.innerHTML,n=!0))}s(e),t.isString(n)&&(n="true"===n),n&&g.templateCache[e.path]||!e.getTemplate?(m.trigger("routeChangeStart",e,e.args),c(g.templateCache[e.path])):(m.trigger("routeChangeStart",e,e.args),g.showLoading(),e.getTemplate.length?(g._waiting=!1,e.getTemplate(c)):c(e.getTemplate()))}function c(e){g.getTemplateCb(d,e,r&&o)}var f=this.routes;i||(i={});for(var d,p=!1,g=this,y=0;d=f[y];y++){var w=e.match(r&&d.$regexp||d.regexp);if(w){var C=w[0];if(d.element){for(var b=!1;d;){if(d.path===C){b=!0;break}if(!d.$child)break;d=d.$child}if(!b){var E=d;d=t.Object.create(E),v.forEach(function(e){d[e]=E[e]}),d.$child=null,E.$child=d,f[y]=d}}d.query=n||{},d.path=C,d.params={},d.historyOptions=i;var k=d.keys;if(w.shift(),k.length&&a(w,d),!(g.$root||g.viewsContainer&&t.hasClass(g.$parentRouteEle,h)))return g.$parent.route(d.path,d.query,i,e,function(){g._waiting=!0,l(d)}),!0;l(d),p=!0}else r||d.$routeView&&(p=d.$routeView.route(e,n,i));if(p)break}return p},setViewsContainer:function(e){this.$parentRouteEle=e;var t,n;e&&(n=this.options.viewsSelector,t=n&&e.querySelector(n),t||(t=e)),this.viewsContainer=t||null},animate:function(e){this.options.animation=!!e},showLoading:function(e){(this.options.showLoading||e)&&(this.maskEle||this.initMaskEle(),this.maskEle.style.visibility="visible")},initMaskEle:function(){this.maskEle=p.cloneNode(),this.maskEle.className=this.options.maskClass,this.maskEle.innerHTML='<i class="'+this.options.maskClass+'-loading"></i>',this.viewsContainer.appendChild(this.maskEle)},hideLoading:function(){this.maskEle&&(this.maskEle.style.visibility="hidden")},getOption:function(e,n,i){if(!e&&!n)return void 0;if(!i)return void 0;var r;return n&&(r=n.data[i]),t.isUndefined(r)&&(r=e[i],t.isUndefined(r)&&(r=this.options[i])),r},getTemplateCb:function(e,n,i){function r(n){e.element=n;var i=t.Array.indexOfByKey(c.pagesCache,e,"path");~i&&c.pagesCache.splice(i,1),c.pagesCache.push(e),c.pageViewState=e,s(),o()}function a(){s(),e.onEnter&&e.onEnter.apply(e,e.args),o()}function s(){v&&(e.$routeView.defaultTemplate||!e.cached)&&(t.innerHTML(g,n),e.cached=!1)}function o(){e.$routeView&&e.$routeView.setViewsContainer(e.element),e.callback.apply(e,e.args),m.trigger("routeChangeEnd",e,e.args),i&&i(),delete c._waiting}this.hideLoading(),e._oldTemplate=this.templateCache[e.path],this.templateCache[e.path]=n;var l,c=this,f=e.historyOptions,d=f.first||!this.pageViewState,p=t.getUIDByKey(e.path);d&&(f.first=d,l=this.viewsContainer.getElementsByClassName(u)[0],this.maskEle&&(this.maskEle.parentNode?this.maskEle.parentNode.removeChild(this.maskEle):this.maskEle=null),this.viewsContainer&&this.viewsContainer!==this.$parentRouteEle&&(this.defaultTemplate=this.viewsContainer.innerHTML,l||(t.innerHTML(this.viewsContainer,""),this.maskEle=null)),this.maskEle&&this.viewsContainer.appendChild(this.maskEle));var g=t.document.getElementById(p);g?e.cached=!0:(g=l||t.document.createElement("div"),g.id=p,e.cached=!1,!l&&this.viewsContainer.appendChild(g));var v=!1;if(e.$routeView&&(v=t.hasClass(g,h)),(!e.cached&&!l||n!==e._oldTemplate)&&(v||t.innerHTML(g,n),e.cached=!1),e.$routeView){if(v)return void e.$routeView._transView(null,e.$routeView.pageViewState,f,a);e.$routeView.pageViewState&&e.$routeView._transView(null,e.$routeView.pageViewState,f)}this._transView(g,e,f,r)},_transView:function(e,n,i,r){function a(){setTimeout(function(){t.removeClass(m.viewsContainer,p)}),k&&$&&m.checkPageViews()}var s=h,o="out",l=o,c="reverse",f="ani",d=s+" "+c,p="overhidden",v=this.pageViewState,m=this;e&&(t.removeClass(e,d),t.addClass(e,u+" "+this.options.viewClass));var y=this._shouldAni(this.options.animation,n,i);if(y=y&&!!r){var w=f,C=f;w+=" "+this.getOption(n,i.state,"aniClass"),i.first||(C+=" "+this.getOption(v,i.oldState,"aniClass")),s=w+" "+s,o=C+" "+o,t.addClass(this.viewsContainer,p)}if("back"===i.direction&&(s+=" "+c,o+=" "+c),v&&(t.removeClass(v.element,d),t.addClass(v.element,o),v.element.offsetWidth=v.element.offsetWidth,v.onLeave&&v.onLeave.apply(v,v.args)),e&&(t.removeClass(e,l),t.addClass(e,s),e.offsetWidth=e.offsetWidth,n.onEnter&&n.onEnter.apply(n,n.args)),!n.cached){var b,E=i.state.hash;E&&(b=t.document.getElementById(E),b&&b.scrollIntoView())}var k=!1,$=!1;return y?(e&&e.addEventListener(g,function _(){k=!0,e.removeEventListener(g,_),t.removeClass(e,w),r&&r(e),a(),_=null}),void(v&&v.element.addEventListener(g,function S(){$=!0,v.element.removeEventListener(g,S),t.removeClass(v.element,C),e||(r&&r(),m.pageViewState=null,m.defaultTemplate&&t.innerHTML(m.viewsContainer,m.defaultTemplate)),a(),S=null,v=null}))):(k=!0,$=!0,r&&r(e),e||(m.pageViewState=null,m.defaultTemplate&&t.innerHTML(m.viewsContainer,m.defaultTemplate)),void a())},_shouldAni:function(e,t,n){var i=this.getOption(t,n.state,"animation"),r=e;return n.first||(r=this.getOption(this.pageViewState,n.oldState,"animation")),i=1==i||"true"==i?!0:!1,r=1==r||"true"==r?!0:!1,e=i&&r&&(!this._waiting||!n.first),n.first&&(e=e&&!this.$root),e},checkPageViews:function(){var e=this.options.cacheViewsNum,n=this.pagesCache;if(!(n.length<=e)){var i=t.Array.indexOfByKey(n,this.pageViewState,"path"),r=0,a=0;for(r=i-Math.floor((e-1)/2),0>r&&(r=0),a=e-1+r,a>n.length-1&&(r-=a-n.length+1,a=n.length-1);r>0;)this.destroyState(n.shift()),r--,a--;for(;a<n.length-1;)this.destroyState(n.pop())}},destroyState:function(e){if(e.$routeView){for(var n=e.$routeView.pagesCache.pop();n;)e.$routeView.destroyState(n),n=e.$routeView.pagesCache.pop();e.$routeView.setViewsContainer(),e.$routeView.pageViewState=null;var i=e.$routeView.maskEle;i&&i.parentNode.removeChild(i),e.$routeView.maskEle=null,e.$routeView=null}t.isFunction(e.onDestroy)&&e.onDestroy();try{e.element&&e.element.parentNode.removeChild(e.element)}catch(r){}e.element=null;var a=t.Object.getPrototypeOf(e);a&&a.$child&&(a.$child=e.$child||null),e.$child&&(t.Object.setPrototypeOf(e.$child,a||null),e.$child=null),t.Object.setPrototypeOf(e,null),e=null},getTemplateCache:function(){return this.templateCache}});var m={errorback:null,init:function(e,n){if(!c&&(e||n)){c=!0,t.isArray(e)||(n=e,e=[]),n&&t.isFunction(n.error)&&(this.error(n.error),delete n.error);var r={};t.extend(r,f,n||{}),this.$routeView=new i(null,null,r),this._add(e)}},route:function(e,t,n){e=e.trim();var i=this.$routeView.route(e,t,n);!i&&this.errorback&&this.errorback(e,t,n)},error:function(e){this.errorback=e},_add:function(e,n,i,r){var a;i||(i=""),t.each(e,function(e){a=e.path;var t=0;i&&(a=i+a,r.$parentArgsLen&&(t+=r.$parentArgsLen),t+=r.keys.length,e.$parentArgsLen=t),e.pattern=a,delete e.path,this.add(a||"/",e.callback,e,n)},this)},add:function(e,n,r,a){"object"==typeof n&&(a=r,r=n),a||(a=this.$routeView);var s=a.routes;if("/"!==e.charAt(0))throw"path必须以/开头";r=r||{},r.callback=n||t.noop,e.length>2&&"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1),r.last="/"),t.Array.ensure(s,this._pathToRegExp(e,r));var o=r.children;if(o){var l={},c=a.options;t.each(d,function(e){l[e]=e in o?o[e]:c[e]});var u=new i(r,a,l);routes=o.routes,delete o.routes,this._add(routes,u,e,r),delete r.children}},_pathToRegExp:function(e,t){for(var n,i,a,s,o=t.keys=[],c="boolean"==typeof t.caseInsensitive?t.caseInsensitive:!0,u="^",h=0;n=l.exec(e);){i=n[2]||n[3],a=n[4]||("*"==n[1]?".*":"string"),s=e.substring(h,n.index);var f=this.$types[a],d={name:i};f&&(a=f.pattern,d.decode=f.decode),o.push(d),u+=r(s,a,!1),h=l.lastIndex}return s=e.substring(h),u+=r(s),t.children&&(t.$regexp=new RegExp(u,c?"i":void 0)),u+=(t.strict?t.last:"/?")+"$",t.regexp=new RegExp(u,c?"i":void 0),t},navigate:function(e,t){"/"===e.charAt(1)&&(e=e.slice(1)),n.push(e,t)},$types:{date:{pattern:"[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])",decode:function(e){return new Date(e.replace(/\-/g,"/"))}},string:{pattern:"[^\\/]*"},bool:{pattern:"0|1",decode:function(e){return 0===parseInt(e,10)?!1:!0}},"int":{pattern:"\\d+",decode:function(e){return parseInt(e,10)}}}};return t.extendByBase(m),n.on("change",function(e,t,i){var r=!1;i||(r=!0);var a=t.url,s=n.getPath(a);if(s||n.base||r){s&&"/"===s||(s="/"+(s||""));var l=o(s);m.route(l.path,l.query,{first:r,direction:e,state:t,oldState:i})}}),m});